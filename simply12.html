<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/x-icon" href="data:image/gif;base64,R0lGODlhEAAQAPcAADMfKjMhLDYjLzomMT4qM0cyOVlAQ2lNTHVZVYNnYZN3cZyAep+DfZ6CfJt/eZh6dTMfKzQhLjklMj4oNT8qMz8qMkkzOFM6PVxCQWdOSXhcV3tfWn1fW3xgW3tdWX1fXDYhLTkkMDomMjwoNjsoNDgmLz0nMUApMjwjKz4mLk4zOFQ4PFc7Plc8PlY6PV5CRjcgLTQfLjchLjohMDkiMDMgLDYhLltFTllCSk45QUMsNTUhLDkjL0IsN0cwPEwzPjchLEcxOmdOUXxgZl9JUTIeKTsmLZqCg5R7eI94dJ+GhYJrb0UuODojMEEsOUIrOEs1O29cWI14caGIhVM+Qh0KE0s1OpN8eYt2b3RcWIJqZZiBfXphYzcfLTokMz0mNFM9QIFvaJB8cquTjWZRUkw2O5R8fX5mZIhzbnBZVFtDPpiCepaAelI8PmBLUUoyPWJLTIJrZJJ8daOLhV1FSGBLSX1nY1M9OHxkYYNpZV5DQJyDeZiEe0o2M4p1b4x1dGNMTIVpZI1wboZqaD8mLjQaInheYFU9O2lQUU4zMpJ5c4ZvaUAoKmxTUpJ6dl1ISHtjW4NqY2ZPTzIbJCsRG4pxcpeEfYRtbGdPSnlgW31mYltDRDYeI1Y+P4x0ck85PWVPTG9WU1xFSDUbKS0THXxmZYRzaX5mZYdxbIFqZWJJSkQrNTgeK0UsN2NJUkUpNUkwN002Oks3OzYgLDIZI2tWVm1cU2lSUG9XUmJIRU40OUAkMTcbKj0gLkQnNUUmNEElMUEkMD8mMjsiLjUaKEcvOEs3Ok0yOE0yNUQoLUIkLzwhLzgcKjwdLD4gMEklM0smNUkkMUQlLz8hLDUYJDcdKT0hLkAgLz8gLD4gK0AgMTwfMDcZKjoaLD4eL0wmNVMqOVArN0ooMkclMjsbKDQWJDgZJj0aKz0dLT8gLj8gLz0eLDgYJzwZKT8dL1QuN2E9QmZDRVs4O1Y0OVAuNU0nMVAoNEgeL0YdMEsgMU4iMkwfMUQbLj8bLEEeLwAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQEewABACwAAAAAEAAQAAAI/wABQAABAwgUMHAAPfr06tezb+8CRAgRI0iUMHECQQIFCxg0cPAESBAhQ4gUMXIERQoVK1i0cPEGTBgxY8iUMXMGSRIlS5g0cfIIUCBBgwgVMnQITRo1a9i0cfMKVChRo0iVMnUKUSJFixg1cvQMWDBhw4gVM3YMVSpVq1i1cvUOXDhx48iVM3cOWTJly5g1c/YQYECBAwkWNHgQXTp169i1c/cSZEiRI0mWNHkSYUKFCxk2dPgUaFChQ4kWNXr0ZEqVK1m2dPkWbFixY8mWNXsUaVKlS5k2dfoYcGDBgwkXNnwWbVq1a9m2dfsadGjRo0mXNn0YcWLFixk3dvwceCRw4cOJFzd+GnVq1atZt3b9Hnx48ePJlzd/HHly5cuZN3f+BAQAOw==">


  <title>Замена-12</title>
  <style>
/*
* Prefixed by https://autoprefixer.github.io/ru/
* PostCSS: v8.4.14,
* Autoprefixer: v10.4.7
* Browsers: last 4 version
*/

*:not(hr), *::after, *::before {
	-webkit-box-sizing: border-box;
	box-sizing: border-box;
	margin:0;
	padding:0;
	border:0
	}

ul {list-style-type: none}
 
body{
	font-family: sans-serif;
	background-color:#ded
	} 
#i{
	padding: 33px 0;
	background: -webkit-gradient(linear, left top, left bottom, from(grey), to(#ded));
	background: -o-linear-gradient(grey, #ded);
	background: linear-gradient(grey, #ded); 
	text-align: center;
	}


.ira{
	position: absolute;
	cursor: move; 
	color: white;
	display: -ms-grid;
	display: grid; 
	place-items:center; 
	-webkit-user-select: none; 
	-moz-user-select: none; 
	-ms-user-select: none; 
	user-select: none;
	font-size:16px;
	width:25px; 
	height: 20px;
    z-index: 9;
	background: red;
	}
.iba{
	margin: 0 2px;
	display: -ms-grid;
	display: grid; 
	place-items: center; 
	-webkit-user-select: none; 
	-moz-user-select: none; 
	-ms-user-select: none; 	
	width: 25px;	
	font-size: 16px;
	color: white;
	background: navy;
	cursor: move;
	user-select: none;
    }	


.km{margin:2px;
	display: -ms-grid;
	display: grid; place-items: center;
	width:43px;  
	border:4px solid blue;
	position: fixed; bottom: 0px;
	background: white;
	font-family : monospace;
	font-size:24px;
	-o-text-overflow: clip;
	   text-overflow: clip;
	color:black;
	letter-spacing:1px;
	z-index:6;
	}


.a:before{
	content: '';
	display:  block;
	position: absolute;
	width: 5px; 
	height: 20px;
	top: -27px;
	left: 15px;
	background: blue;
	}



.b:after{
	content: '';
	display: block;
	position: absolute;
	width: 35px; 
	height: 5px;
	top: -12px;
	left: 2px;
	background: blue;
	}
legend{
	font-family: monospace;
	font-size: 24px;
	text-align: center;
	color: blue;
	}


#m1,#m2,#m3{
	margin: auto; 
	color: white; 
	text-align: left;
	border: 5px solid white;
	font-family : monospace;
	width: -webkit-fit-content;
	width: -moz-fit-content;
	width: fit-content;
	padding: 20px 4%;
	font-size: 22px;
	letter-spacing: 8px;
	line-height: 37px;
	max-width: 800px;
	}
#m1{
	position: absolute; 
	top: 0; 
	left: 0;
	border: 5px solid #ffffff00;
	color: #00000080;
	background: white;
	}
#m2{
	position: absolute; 
	top: 0; 
	left: 0;
	background: transparent;
	padding-top: 5px;
	color: purple;
	font-weight: 700;
	}
#m3{
	visibility:hidden;
	}

article{
	margin: auto;
	position: relative;
	width: -webkit-fit-content;
	width: -moz-fit-content;
	width: fit-content;
	}

#ty{
	padding-top: 100px;
	display: -webkit-box;
	display: -ms-flexbox;
	display: flex;
	-webkit-box-pack: center;
	-ms-flex-pack: center;
	justify-content: center; 
	-webkit-box-align: start; 
	-ms-flex-align: start; 
	align-items: flex-start;
	-ms-flex-wrap: wrap;
	flex-wrap: wrap; 
	visibility: hidden;
	position: fixed; 
	bottom: 10px;
	width: 100%;
	height: 444px;
	background: fuchsia;
	z-index: 5;
	}
#fa{
	width: 100%;
	height: 444px;
	background: transparent;
	position: fixed; 
	bottom: 0;
	display: -webkit-box;
	display: -ms-flexbox;
	display: flex; 
	-webkit-box-align: start;
	-ms-flex-align: start; 
	align-items: flex-start;
	-ms-flex-wrap: wrap;
	flex-wrap: wrap;
	z-index:6;
	}

button{
	margin: 1px;
	padding: 8px 16px; 
	background: #efd;
	border: 2px solid blue; 
	border-radius: 5px;
	font-size: 21px;
	cursor:pointer;
	-webkit-transition: all 1s;
	-o-transition: all 1s;
	transition: all 1s
	}
button:hover{background: #fff;}
p{
	height: 444px; 
	visibility: hidden;
	}
nav{
	position: fixed;
	top: 20px;
	left: 0;
	display: -webkit-box;
	display: -ms-flexbox;
	display: flex; 
	-webkit-box-orient: vertical; 
	-webkit-box-direction: normal; 
	-ms-flex-direction: column; 
	flex-direction: column;
	}
#cop{
	width: calc(100% - 6px);
	height: 222px;
	background: #ded;
	position: absolute; 
	left: -9999px;
	}
.graf{
position: fixed;
top: 1px; right: 1px;
display: grid;
place-items: center;
width: 44px; aspect-ratio: 1;
background: #ded;
border-radius: 20px;
font-size: 30px;
cursor: pointer;
z-index: 50;
}
.graf:hover{transform: scale(1.1)}


#svg{position: absolute;
top:50%; left:50%;
transform: translate(-50%, -50%) scale(2);
display: none;
}
  </style>  
</head>
<body>
	<nav>
		<button id="btn1" onclick="
			ir.forEach((x,i)=>{
				x.style.top=ib[i].offsetTop+'px';
				x.style.left=ib[i].offsetLeft+'px';});	
			conny();// вывод деши
		">reset</button>
		<button onclick="
			//cop.value=m2.innerText;
			cop.value=m2.innerText.replace(/(.{35})( )/g,'$1');
			cop.select();
			document.execCommand('copy');
			window.getSelection()?.removeAllRanges();
		">copy</button>
		<button onclick="
			navigator.clipboard.readText()
				.then(text => {
				//text=[...text].map(i=>i.toUpperCase()).join('');
				text=[...text].map(i=>i.toUpperCase()
					
					)
					.join('').replace(/(.{35})/g,'$1 ');
				
				cop.value=text;
				main(cop.value);
				btn1.onclick();
				})
				.catch(err => {
				console.log('Oblomingo flyed pass', err);
				});
				
		">paste</button>		
	</nav>
	<textarea id="cop">для копирования</textarea>

	<div id=i>
		<article>
			<div id="m3"></div>
			<div id="m1"></div>
			<div id="m2"></div>
		</article>
		<div id="ty"></div>
	</div>
	<form id="fa"></form>
	<p></p>	
	
<div class="graf" onclick="
dataru=!dataru;
this.innerText=['en','ru'][+dataru];
ir.forEach(x=>{x.style.visibility=['hidden','visible'][+dataru]});
svg.style.display=['block','none'][+dataru];
">ru</div>	

<svg id="svg" width="580" height="298" viewBox="0 0 580 298" fill="none">
<style type="text/css">
textPath {font-family: sans-serif; font-size: 16px;}
</style>
<rect class="x" x="0" y="0" width="580" height="298" fill="#ded"></rect>

<g id="figs">
<path class="fg" id="p1" d="m184,252,8,-54,8,54z" fill="lime" stroke="black" stroke-width="1" data-x="184" data-y="252"></path>
<rect class="fg" id="r2" x="224" y="180" width="96" height="72" fill="yellow" stroke="black" stroke-width="1"></rect>
<ellipse class="fg" id="e3" rx="24" ry="9" cx="232" cy="81" fill="aqua" stroke="black" stroke-width="1" style="display: none;"></ellipse>
<ellipse class="fg" id="e4" rx="24" ry="9" cx="296" cy="45" fill="aqua" stroke="black" stroke-width="1" style="display: none;"></ellipse>
<path class="fg" id="p5" d="m232,36,-8,54,16,0z" fill="aqua" stroke="black" stroke-width="1" data-x="232" data-y="36" style="display: none;"></path>
<path class="fg" id="p6" d="m232,36,-8,54,16,0z" fill="red" stroke="black" stroke-width="1" data-x="232" data-y="36" style="display: none;"></path>

<path class="fg" id="p7" d="m288,54,8,-54,8,54z" fill="red" stroke="black" stroke-width="1" data-x="288" data-y="54" style="display: none;"></path>

<path class="fg" id="p30" d="m224,180,0,-18,-16,-54,48,0,-16,54,0,18z" fill="yellow" stroke="black" stroke-width="1" data-x="224" data-y="180"></path>

<path class="fg" id="p9" d="m288,180,8,-18,8,18z" fill="gold" stroke="black" stroke-width="1" data-x="288" data-y="180"></path>

<path class="fg" id="p10" d="m296,153,-8,-27,-16,-27,0,-27,48,0,0,27,-16,27z" fill="gold" stroke="black" stroke-width="1" data-x="296" data-y="153"></path>

<ellipse class="fg" id="e11" rx="24" ry="9" cx="232" cy="108" fill="lime" stroke="black" stroke-width="1"></ellipse>

<ellipse class="fg" id="e12" rx="24" ry="9" cx="296" cy="72" fill="lime" stroke="black" stroke-width="1"></ellipse>

<path class="fg" id="p13" d="m224,117,8,-45,8,45z" fill="red" stroke="black" stroke-width="1" data-x="224" data-y="117"></path>

<path class="fg" id="p14" d="m288,81,8,-45,8,45z" fill="red" stroke="black" stroke-width="1" data-x="288" data-y="81"></path>

<ellipse class="fg" id="e15" rx="24" ry="9" cx="392" cy="135" fill="white" stroke="black" stroke-width="1"></ellipse>

<ellipse class="fg" id="e16" rx="24" ry="9" cx="392" cy="126" fill="aqua" stroke="black" stroke-width="1"></ellipse>

<ellipse class="fg" id="e17" rx="24" ry="9" cx="448" cy="135" fill="white" stroke="black" stroke-width="1"></ellipse>

<ellipse class="fg" id="e18" rx="24" ry="9" cx="448" cy="126" fill="aqua" stroke="black" stroke-width="1"></ellipse>

<path class="fg" id="p19" d="m384,135,8,-36,8,36z" fill="red" stroke="black" stroke-width="1" data-x="384" data-y="135"></path>

<path class="fg" id="p20" d="m440,135,8,-36,8,36z" fill="red" stroke="black" stroke-width="1" data-x="440" data-y="135"></path>

<path class="fg" id="p21" d="m368,153,96,0,-48,63z" fill="gold" stroke="black" stroke-width="1" data-x="368" data-y="153"></path>

<path class="fg" id="p22" d="m416,225,16,27,-32,0z" fill="gold" stroke="black" stroke-width="1" data-x="416" data-y="225"></path>

<path class="fg" id="p23" d="m448,252,8,-18,8,18z" fill="olive" stroke="black" stroke-width="1" data-x="448" data-y="252"></path>

<path class="fg" id="p24" d="m480,252,8,-54,8,54z" fill="black" stroke="black" stroke-width="1" data-x="480" data-y="252"></path>

<path class="fg" id="p25" d="m136,171,8,45,-16,0z" fill="black" stroke="black" stroke-width="1" data-x="136" data-y="171"></path>

<path class="fg" id="p26" d="m152,171,8,45,-16,0z" fill="red" stroke="black" stroke-width="1" data-x="152" data-y="171"></path>

<path class="fg" id="p27" d="m168,171,8,45,-16,0z" fill="black" stroke="black" stroke-width="1" data-x="168" data-y="171"></path>

<rect class="fg" id="r28" x="128" y="216" width="48" height="36" fill="yellow" stroke="black" stroke-width="1"></rect>

<rect class="fg" id="r29" x="128" y="252" width="368" height="36" fill="yellow" stroke="black" stroke-width="1"></rect>
</g>

<defs><path id="tp11" d="M130,167.5 380,-82.5"></path></defs>
<use xlink:href="#tp11"></use>
<text x="0" y="0" fill="navy"><textPath xlink:href="#tp11">
button #btn1</textPath></text>
<defs><path id="tp12" d="M153,165.5 403,-84.5"></path></defs>
<use xlink:href="#tp12"></use>
<text x="0" y="0" fill="navy"><textPath xlink:href="#tp12">button</textPath></text>
<defs><path id="tp13" d="M173,165.5 423,-84.5"></path></defs>
<use xlink:href="#tp13"></use>
<text x="0" y="0" fill="navy"><textPath xlink:href="#tp13">button</textPath></text>
<defs><path id="tp14" d="M190,193.5 440,-56.5"></path></defs>
<use xlink:href="#tp14"></use>
<text x="0" y="0" fill="navy"><textPath xlink:href="#tp14">
textarea #cop</textPath></text>
<defs><path id="tp15" d="M226,66.5 476,-183.5"></path></defs>
<use xlink:href="#tp15"></use>
<text x="0" y="0" fill="navy"><textPath xlink:href="#tp15">
div.</textPath></text>
<defs><path id="tp16" d="M255,98.5 505,-151.5"></path></defs>
<use xlink:href="#tp16"></use>
<text x="0" y="0" fill="navy"><textPath xlink:href="#tp16">
article</textPath></text>
<defs><path id="tp17" d="M291,39.5 541,-210.5"></path></defs>
<use xlink:href="#tp17"></use>
<text x="0" y="0" fill="navy"><textPath xlink:href="#tp17">
div.iba</textPath></text>
<defs><path id="tp18" d="M326,64.5 576,-185.5"></path></defs>
<use xlink:href="#tp18"></use>
<text x="0" y="0" fill="navy"><textPath xlink:href="#tp18">
div.ty</textPath></text>
<defs><path id="tp19" d="M323,174.5 573,-75.5"></path></defs>
<use xlink:href="#tp19"></use>
<text x="0" y="0" fill="navy"><textPath xlink:href="#tp19">
div.i</textPath></text>
<defs><path id="tp20" d="M391,95.5 641,-154.5"></path></defs>
<use xlink:href="#tp20"></use>
<text x="0" y="0" fill="navy"><textPath xlink:href="#tp20">
div.ira</textPath></text>
<defs><path id="tp21" d="M447,96.5 697,-153.5"></path></defs>
<use xlink:href="#tp21"></use>
<text x="0" y="0" fill="navy"><textPath xlink:href="#tp21">
fieldset.km</textPath></text>
<defs><path id="tp22" d="M477,153.5 727,-96.5"></path></defs>
<use xlink:href="#tp22"></use>
<text x="0" y="0" fill="navy"><textPath xlink:href="#tp22">
form #fa</textPath></text>
<defs><path id="tp23" d="M453,228.5 703,-21.5"></path></defs>
<use xlink:href="#tp23"></use>
<text x="0" y="0" fill="navy"><textPath xlink:href="#tp23">
p</textPath></text>
<defs><path id="tp24" d="M497,196.5 747,-53.5"></path></defs>
<use xlink:href="#tp24"></use>
<text x="0" y="0" fill="navy"><textPath xlink:href="#tp24">
div.graf</textPath></text>
<defs><path id="tp25" d="M508,251.5 758,1.5"></path></defs>
<use xlink:href="#tp25"></use>
<text x="0" y="0" fill="navy"><textPath xlink:href="#tp25">
body</textPath></text>
<defs><path id="tp26" d="M183,215.5 433,-34.5"></path></defs>
<use xlink:href="#tp26"></use>
<text x="0" y="0" fill="navy"><textPath xlink:href="#tp26">nav</textPath></text>
<defs><path id="tp27" d="M245,29.5 495,-220.5"></path></defs>
<use xlink:href="#tp27"></use>
<text x="0" y="0" fill="navy"><textPath xlink:href="#tp27">
m3</textPath></text>
<defs><path id="tp28" d="M256,38.5 506,-211.5"></path></defs>
<use xlink:href="#tp28"></use>
<text x="0" y="0" fill="navy"><textPath xlink:href="#tp28">
m1</textPath></text>
<defs><path id="tp29" d="M268,47.5 518,-202.5"></path></defs>
<use xlink:href="#tp29"></use>
<text x="0" y="0" fill="navy"><textPath xlink:href="#tp29">
m2</textPath></text>

<defs><path id="tp30" d="M208,101 258,91"></path></defs>
<use xlink:href="#tp30"></use>
<text x="0" y="0" fill="red"><textPath xlink:href="#tp30">
3</textPath></text>
<defs><path id="tp31" d="M270,65 320,55"></path></defs>
<use xlink:href="#tp31"></use>
<text x="0" y="0" fill="red"><textPath xlink:href="#tp31">
33</textPath></text>
<defs><path id="tp32" d="M365,118 415,108"></path></defs>
<use xlink:href="#tp32"></use>
<text x="0" y="0" fill="red"><textPath xlink:href="#tp32">
33</textPath></text>
<defs><path id="tp34" d="M421,118 471,108"></path></defs>
<use xlink:href="#tp34"></use>
<text x="0" y="0" fill="red"><textPath xlink:href="#tp34">
30</textPath></text>

<line x1="236" y1="44" x2="243" y2="31" stroke="teal"></line>
<line x1="240" y1="46" x2="252" y2="38" stroke="teal"></line>
<line x1="246" y1="48" x2="262" y2="47" stroke="teal"></line>

</svg>

<script>
'use strict';
var dataru=1;
var droba=false; // слова более 35 букв дробить на мелкие
var ir,ib;
let ws;// коорды размеры башен
      //  А  Б  В  Г  Д  Е  Ё  Ж  З  И  Й  К  Л  М  Н  О  П  Р 
const fq=[21,7 ,14,4 ,9 ,34,0 ,4 ,12,21,11,11,12,16,35,38,8 ,12,
		//  С  Т  У  Ф  Х  Ц  Ч  Ш  Щ  Ъ  Ы  Ь  Э  Ю  Я  _
			18,19,8 ,2 ,5 ,1 ,4 ,3 ,2 ,0 ,13,3 ,0 ,0 ,11,45];
const ef='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
const af=[...'АБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ'];
const qf=[...'ОНЕАИТСМВЫЛЗРЙКЯДПУБХГЖЧЬШФЩЦЮЭЪЁ'];
let f;
let o; // обьект
let p;// множество для алфавита шифротекста
let hu,hi;
let t=[];// abcd
let s1;

ty.innerHTML=qf.map((x,i)=>
	{return '<div class="iba" style="height:'+
	(fq[af.indexOf(x)]+21)+
	'px;">'+x+'</div>'}).join('');





function dragElement(ass) {//Make the DIV element draggagle:
	var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
	ass.onmousedown = dragMouseDown;

	function dragMouseDown(e) {
		e = e || window.event;
		// get the mouse cursor position at startup:
		pos3 = e.clientX;
		pos4 = e.clientY;
		document.onmouseup = closeDragElement;
		// call a function whenever the cursor moves:
		document.onmousemove = elementDrag;
		}

	function elementDrag(e) {
		e = e || window.event;
		// calculate the new cursor position:
		pos1 = pos3 - e.clientX;
		pos2 = pos4 - e.clientY;
		pos3 = e.clientX;
		pos4 = e.clientY;
		// set the element's new position:
		ass.style.top = (ass.offsetTop - pos2) + "px";
		ass.style.left = (ass.offsetLeft - pos1) + "px";
		}

	function closeDragElement() {
		/* stop moving when mouse button is released:*/
		document.onmouseup = null;
		document.onmousemove = null;
		[...ir].forEach((x,i)=>{localStorage.setItem(`myXCat11${i}`,x.offsetLeft)});
		[...ir].forEach((x,i)=>{localStorage.setItem(`myYCat11${i}`,x.offsetTop)});
		conny();// вывод деши
		}
}



const ss='И ФЭПЭ ШИЩРЮСЩЬД ЦПСЮЖЮ. ПЦСДЧЩЭ, ЖБЫРСХЭ, ЖЮЖ АЭСГХЭ ЮОБЦЬГЮГХ. Щ ЬЮБЮК, ЖЦГЦБХК ЖЮЛЮСЬН Ь ЛЭТСЩ ЦМЭФД ЦПХЖФЦИЭФФХТ, ВСХС ФЮИЬГБЭМЫ ЦПСЮЖЮТ, ПЫШГЦ ВЦШФНГХК И ФЭПЦ ЖЦБЮПСД. Ю ШИЦБ ФЮВЦТЩФЮС ВЦИЭБУФЦЬГД ВСЮФЭГХ, ЫИЩШЭФФЫЯ Ь ЖЦЬТЩМЭЬЖЦК ИХЬЦГХ. ЦЬГБЦИЖЩ ВХСДФЦК ГБЮИХ, ВЭБЭЬХВЮФФЦК ЬЭШХТЩ ЧЮБЩЖЮТЩ ЦШЫИЮФМЩЖЦИ, ПХСЩ ВЦУЦАЩ ФЮ ЛЭСЭФХК ЮБУЩВЭСЮР, Ю ШЦАШЭИЮН ИЦШЮ И ПЦМЖЭ Ы ЬЮБЮН, ЬСЦИФЦ ЖБЫРСЦЭ ЦЛЭБЦ И ЦГИЭЬФХУ ПЭБЭРЮУ, ЬИЭГЩСЦЬД РЦСЫПЦК ЬЩФЭИЦК. ТЮСДМЩЖ СЯПЩС ИЬЭТЫ ФЮ ЬИЭГЭ ШЮИЮГД ЩТЭФЮ Щ ФЮЛИЮФЩН. ЦФЩ ИЬЭРШЮ ВБЩШЫТХИЮСЩЬД ЬБЮЛЫ. ЛЭБЖЮСДЕЭ ИЦШХ И ПЦМЖЭ ЦФ ФЮЛИЮС ЦЛЭБЦТ ЬЩФЭРЦ ЬИЭГЮ, Ю ВНГФЮ ГБЮИХ ЮБУЩВЭСЮРЦТ ФЭЩЛИЭШЮФФХУ СЭЬЦИ.';
main(ss);


function main(ss){
fa.innerHTML=qf.map((x,i)=>
	{return '<div class="ira" style="height:'+
	(fq[af.indexOf(x)]+21)+
	'px;">'+x+'</div>'}).join('');

p=new Set([...ss].filter(x=>af.indexOf(x)>-1));
const d=Array.from(p).join('');//горд
const q=[...ss].filter(x=>af.indexOf(x)>-1)// частота
	.reduce((a,x)=>{a[x]=~~a[x]+1;return a},{})
const c=[...af].filter(i=>i in q).sort((a,b)=>q[b]-q[a]).map(i=>q[i]-1);//21,14,13
const qa=[...af].filter(i=>i in q).sort((a,b)=>q[b]-q[a]).join('');//отеиc
s1=[...ss].map(x=>(qa.indexOf(x)>-1)?ef[qa.indexOf(x)]:x).join('');

//********************************************

const booa=[...ef].map(x=>{/// однобукыенные слова
	let e=new RegExp('\\b'+x+'\\b','g');
	return e.test(s1);
});

const boob=[...ef].map(x=>{/// удвойенные буквы
	let e=new RegExp(x+x);
	return e.test(s1);
});

let sot=new Set();// ТИПА ключ шифрования замены
let key=[];
[...ss].forEach(x=>{
	if((af.indexOf(x)>-1)&&!sot.has(x))key.push(x); 
	sot.add(x)
});
key=key.concat(af.filter(x=>!sot.has(x)));


//***************************************
t=[];
for (let i=0; i<d.length; i++){t.push(ef[i])}
t=t.join('');
	
let iq4=[...t].map((x,i)=>//аддитивное обьединение двух колод - небоскребы и буквы
'<fieldset class="km'+
`${(booa[i])?' a':''}`+ //вертикальный штрих
`${(boob[i])?' b':''}`+ // горизонтальн штрих
	'" style="left:'+(i*46)+'px">'+x+'</fieldset>').join('');	
fa.innerHTML+=iq4;
ir=[...document.querySelectorAll('.ira')];// подвижные элементы
ib=[...document.querySelectorAll('.iba')];// неподвижные элементы         
ir.forEach((x,i)=>{x.style.left = (localStorage.getItem(`myXCat11${i}`)||ib[i].offsetLeft)+'px';});
ir.forEach((x,i)=>{x.style.top = (localStorage.getItem(`myYCat11${i}`)||1)+'px';});
af.forEach((x,i)=>{dragElement(ir[i])});
//*****************************

hu=document.querySelectorAll('.km');

hi=c.map((x,i)=>`${43+c[i]*400/c[0]|0}px`);
[...hu].forEach((x,i)=>{x.style.height=hi[i]});// высота небоскребов
const sit=()=>{
	ws=[...hu].map(x=>{return {// коорды посадочных мест
		x1:x.offsetLeft,
		x2:x.offsetLeft+x.offsetWidth,
		y1:x.offsetTop,
		y2:x.offsetTop+x.offsetHeight
	}});
}

sit();// пересчет коорд посадок
conny();// вывод деши

window.onresize=()=>{sit()}
//*******************
}// end main

function conny(){// вывод деши
	o=[...t].reduce((a,x)=>{a[x]='.'; return a},{});
	[...ir].forEach((x,i)=>{
		let v=x.offsetLeft+ 12;
		let w=x.getBoundingClientRect().top+20;
		let b=x.innerText;
		for(let j=0; j<t.length;j++){//в какую башню попал
			f=w>ws[j].y1&&w<ws[j].y2;
			if(f&&(v>ws[j].x1)&&(v<ws[j].x2)){o[t[j]]=b}	
		}
	});
	m1.innerHTML=[...s1].map(x=>x).join('');//DAS
	m2.innerHTML=[...s1].map(x=>(x in o)?o[x]:x).join('');
	m3.innerHTML=m2.innerHTML;
}
</script>   
</body>
</html>
